# FPGA 2_Verilog 语言

Verilog 语言是 1983 年由 Gateway Design Automation 公司设计的硬件建模语言，现行标准为 Verilog-2001标准。Verilog 是硬件描述语言，编译下载到 FPGA 是生成电路，Verilog 是并行的，运行速度非常快速。

## 1. Verilog 数据类型

### 常量类型

- 用二进制 b 或 B，八进制 o 或 O，十进制 d 或 D，十六进制 h 或 H 表示数字进制。使用首位数字表示位宽。

> `8’b00001111` 表示 8 位位宽的二进制整数。

- x 代表不定值，z 代表高阻值。

> `5’b00x11`，第三位不定值，`3’b00z` 表示最低位为高阻值。

- 下划线：在位数过长时可以用来分割位数，提高程序可读性。

- 参数 `parameter`: `parameter` 可以用标识符定义常量，运用时只使用标识符即可，提高可读性及维护性。

> `parameter` 可以用于模块间的参数传递，而 `localparam` 仅用于本模块内使用，不能用于参数传递。`localparam` 多用于状态机状态的定义。

### 变量

#### `wire`类型

`wire` 类型变量，也叫网络类型变量，用于结构实体（比如门）之间的物理连接。

- `wire`类型的变量不能储存值，值由驱动元件（门，连续赋值语句，`assign`）决定。
- 如果无驱动元件连接到`wire`类型变量上，则其为高阻状态。

#### `reg`类型

`reg`类型变量，又称寄存器类型，表示一个抽象的数据存储单元。通过赋值语句可以改变寄存器存储的值，`reg`类型的默认初始值为不定值`x`。

- `reg`类型的数据只能在`always`和`initial`语句中赋值。如果为时序逻辑（`always`语句中带有时钟信号），则寄存器变量为触发器。如果为组合逻辑（`always`语句中不带时钟信号，则寄存器变量对应为硬件连线）。
- 可以用 `memory` 类型来定义 RAM,ROM 等存储器，其结构为 `reg [n-1:0] 存储器名[m-1:0]`，意义为 m 个 n 位宽度的寄存器。

## 2. Verilog 运算符

### 算术运算符

`+`，`-`，`*`，`/`，`%`；

### 赋值运算符

`=`阻塞赋值，`<=`非阻塞赋值。阻塞赋值为执行完一条赋值语句，再执行下一条，可理解
为顺序执行，而且赋值是立即执行；非阻塞赋值可理解为并行执行，不考虑顺序，在 `always`块语句执行完成后，才进行赋值。

**一般情况下，在时序逻辑电路中使用非阻塞赋值，可避免仿真时出现竞争冒险现象；在组
合逻辑中使用阻塞赋值，执行赋值语句后立即改变；在 `assign` 语句中必须用阻塞赋值。**

### 关系运算符

`>` ，`<`，`>=`，`<=`，`==`，`!=`

### 逻辑运算符

`&&`，`||`，`!`

### 条件运算符

`?:`

### 位运算符

`~`，`|`，`^`，`&`，`^~`

### 移位运算符

`<<`，`>>`

### 拼接运算符

`{ }`拼接运算符，将多个信号按位拼接

`{a[3:0], b[1:0]}`，将 a 的低 4 位，b 的低 2 位拼接成 6 位数据。

`{n{a[3:0]}}`表示将 n 个 `a[3:0]` 拼接，`{n{1’b0}}`表示 n 位的 0 拼接。

![NULL](./assets/picture_1.jpg)

## 3. 程序设计框架

Verilog 的基本设计单元为模块 Block，Block 由两部分组成，一部分描述接口，另一部分描述内部逻辑功能。

一个 Verilog 程序包括：端口定义，IO说明，内部信号声明，功能定义。

- 端口定义

在`module`中声明端口；

- IO说明

`input`指定输入端口；`output`指定输出端口。

- 功能定义

`assign`语句：描述组合逻辑；

`always`语句：描述组合/时序逻辑；

例化实例元件。

> 上述的逻辑功能是并行的；
>
> 在`always`块中，逻辑是顺序执行的；多个`always`块之间是并行的。
